<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Explanation of the Dragon Cipher</title>
</head>
<body>


<h1>Explanation of the Dragon Cipher</h1>


<p>Dragon is a stream cipher developed at the <a target="_blank" href="https://en.wikipedia.org/wiki/Queensland_University_of_Technology" >Australian Queensland University of Technology (QUT)</a>.

Dragon was a candidate for the <a target="_blank" href="https://web.archive.org/web/20210514233305/https://www.ecrypt.eu.org/stream/dragonp3.html" >eSTREAM project</a>. The version selected for eSTREAM phase 3 is Dragon-128. Dragon is not patented.</p>



<h2>What is the Dragon cipher?</h2>

<p>Dragon was developed by the Information Security Institute (ISI) at the QUT in Brisbane, Australia. It is a stream cipher, based on a nonlinear feedback shift register and a nonlinear filter function with memory. This state is initialized with 128- or 256-bit key-IV pairs. Each clock ("round") produces 64 bits of keystream, using simple operations on 32-bit words. Rounds can be performed repeatedly to generate an infinite stream of pseudorandom data.</p>



<h2>How does the Dragon cipher work?</h2>

<p>Dragon operates in two distinct phases (stages). The initialization stage takes the keying material (128-bit or 256-bit key and IV) and translates it into a complete internal state (1024 bit, plus 64 bit of memory/counter). The keystream generation stage produces 64 bit of the keystream per round of operation.<br>
Both stages utilize the 'update function' F, which uses three 'G' functions (G1, G2, and G3) and three 'H' functions (H1, H2, and H3). Each of the G and H functions index into two selected 8x32-bit S-boxes. The sequential operation of F is depicted in the following picture:</p>

<img src="figure1.png" width="85%"/>

<p>The initialization stage is performed at the initial keying of the cipher, and on every rekeying of the cipher. For security reasons, it is recommended to replace the key and rekey and reinitialize the cipher after every generation of 2^64 bit of keystream. Initialization consists of particular concatenation of the key and IV to produce the initial 1024-bit state (as well as the 64-bit memory/counter value), followed by 16 iterations of the F function. The following pseudo code shows the full initialization procedure:</p>

<img src="figure2.png" width="85%"/>

<p>Once the cipher has been initialized, keystream generation translates the non-linear feedback shift register (NLFSR), as well as the memory/counter value, into 64 bit of keystream and some 'feedback' information that mutates the NLFSR state. The 1024-bit NLFSR is split into thirty-two 32-bit words, labelled B0 through B31. This keystream generation process is depicted as follows:</p>

<img src="figure3.png" width="85%"/>
<img src="figure4.png" width="85%"/>


<h2>Why is the Dragon cipher useful?</h2>

<p>The Dragon cipher has not yet been proven to be insecure. Some attacks, such as a
distinguishing attack, have been raised and subsequently dismissed. So it can arguably be considered being secure enough to protect sensitive data. It is fast in both hardware and software, with a 3.2GHz Pentium 4 processor capable of calculating 3.8 Gbps of keystream, and a hardware implementation using a Samsung ASIC capable of calculating 23 Gbps of keystream.</p>


<h2>Where can I go to find out more?</h2>

<p>The design paper <span class="cite">[<a href="#XJeSTChen">1</a>]</span>, written by several members of the ISI, is basis for the ideas and figures used in this document.
A complete implementation of the cipher in C as well as further information regarding Dragon, can be obtained from the <a target="_blank" href="https://web.archive.org/web/20210514233305/https://www.ecrypt.eu.org/stream/dragonp3.html" >eSTREAM Phase 3</a> website. The former ISI website at http://www.isi.qut.edu.au/resources/dragon/ is no more accessible. More recent publications can be found in the reference section.</p>




<h2>References</h2>

<ul>
<li>
    [1] <a id="XJWikipDragon"></a>
    <a target="_blank" href="https://en.wikipedia.org/wiki/Dragon_(cipher)" >https://en.wikipedia.org/wiki/Dragon_(cipher)</a> Wikipedia Dragon (cipher) 
</li>

<li>
    [2] <a id="XJQUTChen"></a>
    <a target="_blank" href="https://eprints.qut.edu.au/10107/1/Dragon-A_Fast_Word_Based_Stream_Cipher.pdf" >https://eprints.qut.edu.au/10107/1/Dragon-A_Fast_Word_Based_Stream_Cipher.pdf</a> Dragon: A Fast Word Based Stream Cipher (including test vectors), 2005
</li>

<li>
    [3] <a id="XJFastImpl"></a>
    <a target="_blank" href="https://eprints.qut.edu.au/24788/1/Ensuring_Fast_Implementations_of_Symmetric_Ciphers_on_the_Intel_Pentium_4_and_Beyond.pdf" >https://eprints.qut.edu.au/24788/1/Ensuring_Fast_Implementations_of_Symmetric_Ciphers_on_the_Intel_Pentium_4_and_Beyond.pdf</a> Ensuring Fast Implementations of Symmetric Ciphers on the Intel Pentium4 and Beyond, 2006
</li>

<li>
    [4] <a id="XJHenr_PhD"></a>
    <a target="_blank" href="https://eprints.qut.edu.au/16055/" >https://eprints.qut.edu.au/16055/</a> Henricksen, Matthew (2005): Design, Implementation and Cryptanalysis of Modern Symmetric Ciphers, PhD thesis
</li>

<li>
    [5] <a id="XJHamd_PhD"></a>
    <a target="_blank" href="https://eprints.qut.edu.au/66721/1/Ali%20Abdulaziz%20H_Al%20Hamdan_Thesis.pdf" >https://eprints.qut.edu.au/66721/1/Ali%20Abdulaziz%20H_Al%20Hamdan_Thesis.pdf</a> Ali Abdulaziz Alhamdan (2014): Secure Stream Cipher Initialisation Processes
</li>
</ul>

<br>


</body>
</html>
