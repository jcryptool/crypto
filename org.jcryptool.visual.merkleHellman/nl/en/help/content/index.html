<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Merkle-Hellman Knapsack Cryptosystem</title>
</head>
<body>
<h1>Merkle-Hellman Knapsack Cryptosystem</h1>

<p>
This online help describes the functionality of the plug-in <b>Merkle-Hellman</b>.
<p>

Table of contents:<br>
<br>
<b>1)</b> <a href="#Kapitel1"><b>Key generation</b></a><br>
<br>
<b>2)</b> <a href="#Kapitel2"><b>Encryption</b></a><br>
<br>
<b>3)</b> <a href="#Kapitel3"><b>Decryption</b></a><br>
<br>
<b>4)</b> <a href="#Kapitel4"><b>Meaning of the icons in the menu bar</b></a><br>
<br>
<b>5)</b> <a href="#Kapitel5"><b>Sources</b></a>

<p>
The plug-in can be started via the menu <b>Visuals</b> or via the crypto explorer tab <b>Visuals</b>.
<p>

<img width="700" src="merkleHellman_main.jpg">

<p>
The plug-in consists of a description field at the top, and three basic areas below: <b>Key generation</b>, <b>Encryption</b> and <b>Decryption</b>.

<p>
In the description field the corresponding statements about the algorithm are displayed dynamically,
depending on which step of the algorithm the user is currently performing.
<p>
<a name="Kapitel1"><b>1) Key generation</b></a> 
<p>
This section summarizes the actions that are required to generate a private key
and a public key.

<p>
First of all the number of the elements for the private key and the
initial start value must be selected from the drop-down boxes. By default, the
number of elements for the private key is 4 and the start value is $32$. The
start value is needed for the generation of the first element of the private key
 A(1). It will be used a random number in the range of [start value/2 - start
value]. The number of the private key elements will be dynamically created
depending on user selection.
<p>
<img width="700" src="merkleHellman_key.jpg">
<p>

On this selection, the user can either use the automatically and randomly generated sample values for <b>A(i)</b>, <b>M</b> and <b>W</b>, or he can manually enter new values, or he can generate new values for the private key by clicking the button <b>Generate private key</b> <img src="merkleHellman_generatePrivKey.jpg">.

<p>
If the entered private key elements A(i) are not a superincreasing vector and the user is clicking on the button <img src="merkleHellman_generatePubKey.jpg" style="vertical-align:middle">, the user gets displayed the following note message:
<p>
<img src="merkleHellman_superIncreasing.jpg">
<p>

There is also a check for the parameters ​​<b>M</b> and <b>W</b> when the user is clicking the button <img src="merkleHellman_generatePubKey.jpg" style="vertical-align:middle">. Depending on which condition is violated different information dialogs pop up.
<p>
For M <= SUM(A(i)) the following information is shown:
<p>
<img src="merkleHellman_M.jpg">
<p>
For ggT(M,W) != 1 the following information is shown:
<p>
<img src="merkleHellman_W.jpg">
<p>

After all conditions are met the public key will be calculated and the elements B(i) are shown in the <b>Public key B</b> area.
<p>
<img width="700" src="merkleHellman_pubKey.jpg">
<p>

<a name="Kapitel2"><b>2) Encryption</b></a> 
<p>

After the keys have been generated, the user can enter a message <b>m</b> in the corresponding field. As you type the message, the binary representation is dynamically calculated in addition and shown below in the field <b>binary representation of m</b>. The button <img src="merkleHellman_encrypt.jpg" style="vertical-align:middle"> will be activated once a valid value <b>m</b> is entered.
<p>
<img src="merkleHellman_bin.jpg">
<p>
When you click on the button <img src="merkleHellman_encrypt.jpg" style="vertical-align:middle"> the message parts are calculated and the iterations of the calculation will be shown in the table below. The ciphertext is calculated, displayed and entered into the decryption area.
<p>
<img src="merkleHellman_encryptIteration.jpg">
<p>

<a name="Kapitel3"><b>3) Decryption</b></a> 
<p>
For the decryption you can enter any value for <b>c</b>. The binary representation of the entered value is dynamically calculated and shown again. 

<p>
<img src="merkleHellman_decrypt.jpg">
<p>
By clicking the button <img src="merkleHellman_decrypt_button.jpg" style="vertical-align:middle"> the ciphertext will be decryped and its iterations of the calculation will be shown in the table. After the decryption the user has the possibility to decrypt other messages with the same keys.
<p>
<img src="merkleHellman_decrypt_iteration.jpg">
<p>
In case that the decryption was successful the following message will be displayed and both the plaintext and the ciphertest will be colored green:
<p>
<img src="merkleHellman_decrypt_success.jpg">
<p>
Otherwise, the plaintext and the ciphertext are highlighted in red color and the following message appears:
<p>
<img src="merkleHellman_decrypt_failed.jpg">
<p>

<a name="Kapitel4"><b>4) Meaning of the icons in the menu bar</b></a>
<p>
<ol type="a">
	<li>Clicking on the icon <img src="merkleHellman_icon_new.jpg" style="vertical-align:middle"> (Restart) brings the plug-in back to its initial state of the plug-in back, so you can start the algorithm from scratch.</li>
	<li>You can change the values of the private key by clicking on the icon <img src="merkleHellman_icon_undo.jpg" style="vertical-align:middle"> (Reset function). Clicking this icon deletes all entries in the plug-in besides the private key.
</ol>

<p>
<a name="Kapitel5"><b>5) References</b></a> 
<ol type="1">
<li>&nbsp Wikipedia-Link <a href="http://en.wikipedia.org/wiki/Merkle%E2%80%93Hellman_knapsack_cryptosystem">Merkle-Hellman-Kryptosystem</a>
<li>&nbsp Dogan, Ferit: <i>Design and implementation of plug-ins for JCrypTool - Merkle-Hellman and Hashes Visualization</i> Diploma Thesis 2015 - TU-Darmstadt
</ol>

</body>
</html>